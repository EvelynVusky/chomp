/usr/local/opt/llvm/bin/lli

###### Testing test-add
dune exec toplevel tests/test-add.chomp > test-add.ll
llc -relocation-model=pic test-add.ll > test-add.s
cc -o test-add.exe test-add.s linked_funcs.o
./test-add.exe
diff -b test-add.out tests/test-add.out > test-add.diff
###### SUCCESS

###### Testing test-builtins
dune exec toplevel tests/test-builtins.chomp > test-builtins.ll
llc -relocation-model=pic test-builtins.ll > test-builtins.s
cc -o test-builtins.exe test-builtins.s linked_funcs.o
./test-builtins.exe
diff -b test-builtins.out tests/test-builtins.out > test-builtins.diff
###### SUCCESS

###### Testing test-for
dune exec toplevel tests/test-for.chomp > test-for.ll
llc -relocation-model=pic test-for.ll > test-for.s
cc -o test-for.exe test-for.s linked_funcs.o
./test-for.exe
diff -b test-for.out tests/test-for.out > test-for.diff
###### SUCCESS

###### Testing test-list-scope
dune exec toplevel tests/test-list-scope.chomp > test-list-scope.ll
llc -relocation-model=pic test-list-scope.ll > test-list-scope.s
cc -o test-list-scope.exe test-list-scope.s linked_funcs.o
./test-list-scope.exe
diff -b test-list-scope.out tests/test-list-scope.out > test-list-scope.diff
###### SUCCESS

###### Testing test-list
dune exec toplevel tests/test-list.chomp > test-list.ll
llc -relocation-model=pic test-list.ll > test-list.s
cc -o test-list.exe test-list.s linked_funcs.o
./test-list.exe
diff -b test-list.out tests/test-list.out > test-list.diff
###### SUCCESS

###### Testing test-scope
dune exec toplevel tests/test-scope.chomp > test-scope.ll
llc -relocation-model=pic test-scope.ll > test-scope.s
cc -o test-scope.exe test-scope.s linked_funcs.o
./test-scope.exe
diff -b test-scope.out tests/test-scope.out > test-scope.diff
###### SUCCESS

###### Testing fail-add
dune exec toplevel < tests/fail-add.chomp 2> fail-add.err >> testall.log
diff -b fail-add.err tests/fail-add.err > fail-add.diff
###### SUCCESS

###### Testing fail-list
dune exec toplevel < tests/fail-list.chomp 2> fail-list.err >> testall.log
diff -b fail-list.err tests/fail-list.err > fail-list.diff
###### SUCCESS
